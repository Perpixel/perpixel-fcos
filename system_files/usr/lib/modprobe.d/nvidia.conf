## Nouveau must be blacklisted here as well beside from the initrd to avoid a
## delayed loading (for example on Optimus laptops where the Nvidia card is not
## driving the main display).

blacklist nouveau

## Make a soft dependency for nvidia-uvm as adding the module loading to
## /usr/lib/modules-load.d/nvidia-uvm.conf for systemd consumption, makes the
## configuration file to be added to the initrd but not the module, throwing an
## error on plymouth about not being able to find the module.
## Ref: /usr/lib/dracut/modules.d/00systemd/module-setup.sh

## Even adding the module is not the correct thing, as we don't want it to be
## included in the initrd, so use this configuration file to specify the
## dependency.
# softdep nvidia post: nvidia-uvm

options nvidia-drm modeset=1
# options nvidia-drm fbdev=1

## https://download.nvidia.com/XFree86/Linux-x86_64/550.135/README/dynamicpowermanagement.html
# options nvidia NVreg_DynamicPowerManagement=0x00 # 0x01, 0x02 only for notebooks. default 0x00

## https://download.nvidia.com/XFree86/Linux-x86_64/550.135/README/powermanagement.html
## If both the platform and the NVIDIA GPU support S0ix-based power management,
## then the NVIDIA Linux driver will put the GPU video memory in self refresh mode during s2idle system suspend
# options nvidia NVreg_EnableS0ixPowerManagement=1

## Preserve all video memory allocations
options nvidia NVreg_PreserveVideoMemoryAllocations=1
options nvidia NVreg_TemporaryFilePath=/var/tmp
